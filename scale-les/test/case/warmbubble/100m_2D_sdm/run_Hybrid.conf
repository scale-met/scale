#####
#
# Scale3 run configulation
#
#####

&PARAM_PRC
 PRC_NUM_X       = 2,
 PRC_NUM_Y       = 1,
 PRC_PERIODIC_X  = .true.
 PRC_PERIODIC_Y  = .true.
/


&PARAM_INDEX
 KMAX =50, ! num of indices for one process
 IMAX =40,
 JMAX =2,
/

&PARAM_GRID
 DZ = 100.0,
 DX = 100.0,
 DY = 100.0,
 BUFFER_DZ = 0.0,
/

&PARAM_TRACER
 TRACER_TYPE = 'SDM',
/

&PARAM_TIME
 TIME_STARTDATE             = 0000, 1, 1, 0, 0, 0,
 TIME_STARTMS               = 0.D0, ! mill second
 TIME_DURATION              = 10.D0,
 TIME_DURATION_UNIT         = "SEC",
 TIME_DT                    = 0.2D0,
 TIME_DT_UNIT               = "SEC",
 TIME_DT_ATMOS_DYN          = 0.1D0,
 TIME_DT_ATMOS_DYN_UNIT     = "SEC",
 TIME_DT_ATMOS_PHY_MP       = 0.2D0,
 TIME_DT_ATMOS_PHY_MP_UNIT  = "SEC",
 TIME_DT_ATMOS_RESTART      = 1800.D0,
 TIME_DT_ATMOS_RESTART_UNIT = "SEC",
/

&PARAM_STATS
 STAT_checktotal     = .false.,
 STAT_use_globalcomm = .false.,
/

&PARAM_ATMOS
 ATMOS_DYN_TYPE    = "HEVE",
 ATMOS_PHY_SF_TYPE = "OFF",
 ATMOS_PHY_TB_TYPE = "OFF",
 ATMOS_PHY_MP_TYPE = "SDM",
 ATMOS_PHY_RD_TYPE = "OFF",
/

&PARAM_ATMOS_VARS
 ATMOS_RESTART_IN_BASENAME      = "init_00000000000.000",
! ATMOS_RESTART_IN_BASENAME      = "run1/restart_00000001200.000",
 ATMOS_RESTART_OUT_BASENAME     = "restart",
 ATMOS_RESTART_OUTPUT           = .false.,
 ATMOS_VARS_CHECKRANGE          = .true.,
/

# numerical diffusion and pressure gradient force
&PARAM_ATMOS_REFSTATE
 ATMOS_REFSTATE_TYPE       = "INIT",
/

&PARAM_ATMOS_BOUNDARY
 ATMOS_BOUNDARY_TYPE       = "CONST",
 ATMOS_BOUNDARY_USE_VELZ   = .true.,
 ATMOS_BOUNDARY_VALUE_VELZ =  0.D0,
 ATMOS_BOUNDARY_TAUZ       = 10.D0,
/

&PARAM_ATMOS_DYN
 ATMOS_DYN_NUMERICAL_DIFF_COEF = 1.D-3,
/

&PARAM_ATMOS_PHY_MP
 docondensation   = .true.,
 doautoconversion = .true.,
 doprecipitation  = .true.,
/

#  for the 1st run do not use SD_IN_BASENAME
#  from the second run do use SD_IN_BASENAME 
&PARAM_ATMOS_PHY_MP_SDM
 RANDOM_IN_BASENAME = "random_number_init",
 RANDOM_OUT_BASENAME = "random_number_restart",
 SD_OUT_BASENAME = "superdroplet_restart",
 domovement       = .true.,
 sdm_rqc2qr       = 40.d-6,
 sdm_dtcmph       = 0.1d0, 0.1d0, 0.2d0, ! condensation, coalescence, advection 
				       	 ! sdm_dtcmph should be submultiple of TIME_DT_ATMOS_PHY_MP
 sdm_rdnc         = 0.d0,
 sdm_sdnmlvol     = 1.d+6,
 sdm_inisdnc      = 80.0d0,
 sdm_zlower       =    0.d0,
 sdm_zupper       = 4000.d0,
 sdm_aslset       = -1,                  ! if abs(sdm_aslset)>=10, aerosol nucleation occurs. turn this off for now
 sdm_aslmw        = -999.d0,
 sdm_extbuf       = 10,
 sdm_aslfmrate    = 0.d0,
 sdm_aslfmdt      = 0.d0,
 sdm_aslfmsdnc    = 0.d0,
 sdm_colbrwn      = 0,
 sdm_colkrnl      = 2,
 sdm_mvexchg      = 0,
 sdm_nadjdt       = 0.d0,
 sdm_nadjvar      = 0,  ! Control flag of adjustment super-droplet number in each grid
                        ! 3:adjust number of droplet by adding and removal, 1:adjust number of droplet by adding
                        ! 2:adjust number of droplet by removal 0:No adjust number of droplet 
			! use 0 and turn this function off for now
 sdm_dmpvar  = 001,    ! Control flag to output Super Droplets, integer
                       ! 1st digit (10^0) corresponds to text output
                       ! 2nd digit (10^1) corresponds to binary output
                       ! 3rd digit (10^2) corresponds to binary output of large droplets 
                       ! 0: off, 1: on, 2: output with sort data (only for binary output)
                       ! currently only 001 is supported   
 sdm_dmpitva  = 100.d0, ! Time interval of text output, real(RP) [s]
 sdm_dmpnskip = 1,     ! Base skip to store super droplets in text format, integer
 sdm_dmpitvb  = 100.d0,  ! Time interval of binary output of all droplets, real(RP) [s]
 sdm_dmpitvl  = 100.d0,  ! Time interval of binary output of large droplets, real(RP) [s]
 sdm_dmpsdsiz = 0.d0,  ! Threshold radius to store large super droplets in binary format, real(RP) [m]
/


&PARAM_HISTORY
 HISTORY_DEFAULT_BASENAME  = "history",
 HISTORY_DEFAULT_TINTERVAL = 100.D0,
 HISTORY_DEFAULT_TUNIT     = "SEC",
 HISTORY_DEFAULT_TAVERAGE  = .false.,
 HISTORY_DEFAULT_DATATYPE  = "REAL4",
/

&HISTITEM item='U'    /
&HISTITEM item='V'    /
&HISTITEM item='W'    /
&HISTITEM item='PT'   /
&HISTITEM item='RH'   /
&HISTITEM item='RHI'  /

&HISTITEM item='RAERO' /
&HISTITEM item='QHYD' /
&HISTITEM item='QV'   /
&HISTITEM item='QC'   /
&HISTITEM item='QR'   /
&HISTITEM item='QI'   /
&HISTITEM item='QS'   /
&HISTITEM item='QG'   /
&HISTITEM item='NC'   /
&HISTITEM item='NR'   /
&HISTITEM item='NI'   /
&HISTITEM item='NS'   /
&HISTITEM item='NG'   /

&HISTITEM item='QV_t_mp' /
&HISTITEM item='QC_t_mp' /
&HISTITEM item='QR_t_mp' /
&HISTITEM item='QI_t_mp' /
&HISTITEM item='QS_t_mp' /
&HISTITEM item='QG_t_mp' /
&HISTITEM item='RHOE_t_mp' /
&HISTITEM item='Vterm_QR' /
&HISTITEM item='Vterm_QI' /
&HISTITEM item='Vterm_QS' /
&HISTITEM item='Vterm_QG' /
&HISTITEM item='PREC' /
&HISTITEM item='RAIN' /
&HISTITEM item='SNOW' /
&HISTITEM item='QC_sd' /
&HISTITEM item='QR_sd' /

&PARAM_MONITOR
 MONITOR_STEP_INTERVAL = 20,
/

&MONITITEM item='QDRY' /
&MONITITEM item='QTOT' /
&MONITITEM item='ENGT' /
&MONITITEM item='ENGP' /
&MONITITEM item='ENGK' /
&MONITITEM item='ENGI' /

&MONITITEM item='QV'   /
&MONITITEM item='QC'   /
&MONITITEM item='QR'   /
&MONITITEM item='QI'   /
&MONITITEM item='QS'   /
&MONITITEM item='QG'   /
